/*! calendar author:tianxiangbing email:55342775@qq.com
* demo:http://www.lovewebgames.com/jsmodule/dialog.html 
* git:https://github.com/tianxiangbing/dialog  2015-04-02 */
function Dialog(){var a=Math.random().toString().replace(".","");this.id="dialog_"+a,this.settings={},this.settings.closeTpl=$('<span class="ui-dialog-close js-dialog-close">x</span>'),this.settings.titleTpl=$('<div class="ui-dialog-title"></div>'),this.timer=null,this.showed=!1,this.mask=$()}Dialog.prototype={init:function(a){this.settings=$.extend({},this.settings,a),this.settings.mask&&(this.mask=$('<div class="ui-dialog-mask"/>'),$("body").append(this.mask)),$("body").append('<div class="ui-dialog" id="'+this.id+'"></div>'),this.dialogContainer=$("#"+this.id);var b=this.settings.zIndex||10;this.dialogContainer.css({zIndex:b}),this.settings.className&&this.dialogContainer.addClass(this.settings.className),this.mask.css({zIndex:b-1}),this.settings.closeTpl&&this.dialogContainer.append(this.settings.closeTpl),this.settings.title&&(this.dialogContainer.append(this.settings.titleTpl),this.settings.titleTpl.html(this.settings.title)),this.bindEvent(),this.settings.show&&this.show()},touch:function(a,b){function c(a){return b.call(this,a)}var d;$(a).on("click",c),$(a).on("touchmove",function(){d=!0}).on("touchend",function(a){if(a.preventDefault(),!d){var c=b.call(this,a,"touch");c||(a.preventDefault(),a.stopPropagation())}d=!1})},bindEvent:function(){var a=this;this.settings.trigger&&($(this.settings.trigger).click(function(){a.show()}),a.touch($(this.settings.trigger),function(){a.show()})),$(this.dialogContainer).delegate(".js-dialog-close","click",function(){return a.hide(),!1}),$(window).resize(function(){a.setPosition()}),$(window).scroll(function(){a.setPosition()}),$(window).keydown(function(b){27===b.keyCode&&a.showed&&a.hide()})},dispose:function(){this.dialogContainer.remove(),this.mask.remove()},hide:function(){var a=this;a.settings.beforeHide&&a.settings.beforeHide.call(a,a.dialogContainer),this.showed=!1,this.mask.hide(),this.settings.animate?(this.dialogContainer.removeClass("zoomIn").addClass("zoomOut"),setTimeout(function(){a.dialogContainer.hide(),"object"==typeof a.settings.target&&$("body").append(a.dialogContainer.hide()),a.settings.afterHide&&a.settings.afterHide.call(a,a.dialogContainer)},500)):(this.dialogContainer.hide(),"object"==typeof this.settings.target&&$("body").append(this.dialogContainer),this.settings.afterHide&&this.settings.afterHide.call(this,this.dialogContainer))},show:function(){this.dailogContent="string"==typeof this.settings.target?$(/^(\.|\#\w+)/gi.test(this.settings.target)?this.settings.target:"<div>"+this.settings.target+"</div>"):this.settings.target,this.mask.show(),this.dailogContent.show(),this.height=this.settings.height||"auto",this.width=this.settings.width||"auto",this.dialogContainer.append(this.dailogContent).show().css({height:this.height,width:this.width}),this.settings.beforeShow&&this.settings.beforeShow.call(this,this.dialogContainer),this.showed=!0,this.setPosition(),this.settings.animate&&this.dialogContainer.addClass("zoomIn").removeClass("zoomOut").addClass("animated")},setPosition:function(){if(this.showed){var a=this;this.dialogContainer.show(),this.height=this.settings.height,this.width=this.settings.width,isNaN(this.height)&&(this.height=this.dialogContainer.outerHeight&&this.dialogContainer.outerHeight()||this.dialogContainer.height()),isNaN(this.width)&&(this.width=this.dialogContainer.outerWidth&&this.dialogContainer.outerWidth()||this.dialogContainer.width());var b=Math.min(document.documentElement.clientHeight,document.body.clientHeight),c=Math.min(document.documentElement.clientWidth,document.body.clientWidth),d=this.width/2,e=this.height/2,f=c/2-d,g=b/2-e;f=Math.max(0,f),g=Math.max(0,g),a.dialogContainer.css({position:"fixed",top:g,left:f})}}},function(a){a.fn.Dialog=function(b){var c=[];return a(this).each(function(){var d=new Dialog,e=a.extend({trigger:a(this)},b);d.init(e),c.push(d)}),c},a.Dialog=function(b){if("alert"===b.type){var c=new Dialog,d='<div class="ui-alert-title">'+b.content+"</div>",e="";b.button?("boolean"==typeof b.button&&(b.button="确定"),e='<p class="ui-dialog-action"><button class="ui-alert-submit  js-dialog-close">'+b.button+"</button></p>"):b.timer||(b.timer=3e3),d+=e;var f=a.extend({target:d,animate:!0,show:!0,mask:!0,className:"ui-alert",afterHide:function(){this.dispose(),b.callback&&b.callback()}},b);c.init(f),b.timer&&setTimeout(function(){c.dispose(),b.callback&&b.callback()},b.timer)}if("confirm"===b.type){var g=new Dialog,d='<div class="ui-confirm-title">'+b.content+"</div>",e="";b.buttons||(b.buttons=[{yes:"确定"},{no:"取消"}]);for(var h="",i=0,j=b.buttons.length;j>i;i++){var k=b.buttons[i];k.yes&&(h+='<td><button class="ui-confirm-submit " data-type="yes">'+k.yes+"</button></td>"),k.no&&(h+='<td><button class="ui-confirm-no" data-type="no">'+k.no+"</button></td>"),k.close&&(h+='<td><button class="ui-confirm-close js-dialog-close" data-type="close">'+k.close+"</button></td>")}e='<table class="ui-dialog-action"><tr>'+h+"</tr></table>",d+=e;var l=a.extend({target:d,animate:!0,show:!0,mask:!0,className:"ui-alert",afterHide:function(){this.dispose()},beforeShow:function(c){g.touch(a(".ui-confirm-submit",c),function(){b.callback&&b.callback.call(g,"yes",c)}),g.touch(a(".ui-confirm-no",c),function(){b.callback&&b.callback.call(g,"no",c)}),g.touch(a(".ui-confirm-close",c),function(){b.callback&&b.callback.call(g,"close",c)})}},b);g.init(l)}},a.alert=function(b,c,d,e){a.Dialog({content:b,button:c,timer:e,callback:d,zIndex:100,type:"alert"})},a.confirm=function(b,c,d){a.Dialog({content:b,buttons:c,callback:d,zIndex:100,type:"confirm"})}}($);